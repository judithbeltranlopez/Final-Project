---
title: "eda_census"
output: html_document
---


```{r}
library(tidyverse)
library(janitor)
#library(DataExplorer)

df <- read_csv("../data/SAP2022T11T1TOWN22.20251128T151123.csv") %>%
  clean_names()

df_clean <- df %>%
  filter(means_of_travel != "Not stated")

df_clean <- df_clean %>%
  mutate(
    health_group = if_else(
      means_of_travel %in% c("On Foot", "Bicycle"),
      "Healthy",
      "Not healthy"
    )
  )


head(df_clean)
glimpse(df_clean)
```



```{r}
summary(df_clean)

```




```{r}
df_clean %>% summarise(
  n_towns = n_distinct(towns_2022),
  n_means = n_distinct(means_of_travel),
  n_years = n_distinct(census_year)
)
```





```{r}
df_clean %>%
  group_by(towns_2022, means_of_travel) %>%
  summarise(total = sum(value), .groups = "drop") %>%
  arrange(desc(total)) %>%
  head(20)
```




```{r}
df_clean %>%
  group_by(means_of_travel) %>%
  summarise(total = sum(value)) %>%
  ggplot(aes(x = reorder(means_of_travel, total), y = total)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(title = "Total Usually Resident Population by Travel Mode",
       x = "Means of Travel", y = "Total")
```



```{r}
df_clean %>%
  filter(means_of_travel == "On Foot") %>%
  slice_max(order_by = value, n = 10) %>%
  ggplot(aes(x = reorder(towns_2022, value), y = value)) +
  geom_col(fill = "darkgreen") +
  coord_flip() +
  labs(title = "Top 10 Towns â€“ Walking to Work", x = "Town", y = "People")

```



```{r}
unique(df_clean$means_of_travel)
```



```{r}
df_clean %>%
  group_by(health_group) %>%
  summarise(total = sum(value)) %>%
  ggplot(aes(x = reorder(health_group, total), y = total)) +
  geom_col(fill = "steelblue") +
  coord_flip() +
  labs(title = "Total Usually Resident Population by Travel Mode",
       x = "Health group", y = "Total")
```


```{r}

```


```{r}

```


```{r}

```


```{r}

```


```{r}

```